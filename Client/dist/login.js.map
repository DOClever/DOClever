{"version":3,"sources":["webpack:///./web/controller/login/login.js"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA,iCAAiC;AACjC,6BAA6B;AAC7B,yBAAyB;AACzB;AACA;AACA,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,iBAAiB;AACjB;AACA,SAAS;AACT;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,C","file":"login.js","sourcesContent":["var vue=new Vue({\r\n    el: \"#app\",\r\n    data: {\r\n        username:\"\",\r\n        pwd:\"\",\r\n        loginPending:false,\r\n        remember:0,\r\n        openId:\"\"\r\n    },\r\n    methods:{\r\n        login:function () {\r\n            var _this=this;\r\n            if(!this.username || !this.pwd)\r\n            {\r\n                this.$message.error('用户名密码不能为空');\r\n                return;\r\n            }\r\n            this.loginPending=true;\r\n            net.post(\"/user/login\",{\r\n                name:_this.username,\r\n                password:_this.pwd,\r\n            },{\r\n                \"content-type\":\"application/x-www-form-urlencoded\"\r\n            }).then(function (data) {\r\n                _this.loginPending=false;\r\n                if(data.code==200)\r\n                {\r\n                    _this.$notify({\r\n                        title: '登录成功',\r\n                        type: 'success'\r\n                    });\r\n                    session.clear()\r\n                    session.update(data.data,_this.remember);\r\n                    setTimeout(function () {\r\n                        location.href=\"../console/console.html\"\r\n                    },1500);\r\n                }\r\n                else\r\n                {\r\n                    _this.$notify({\r\n                        title: data.msg,\r\n                        type: 'error'\r\n                    });\r\n                }\r\n            })\r\n        },\r\n        qqLogin:function() {\r\n            var _this=this;\r\n            var win=QC.Login.showPopup({});\r\n            var loop=setInterval(function () {\r\n                if(win.closed)\r\n                {\r\n                    clearInterval(loop);\r\n                    if(QC.Login.check())\r\n                    {\r\n                        var obj;\r\n                        QC.api(\"get_user_info\", {}).success(function(s){\r\n                            obj=s.data;\r\n                            QC.Login.getMe(function (openId,accessToken) {\r\n                                _this.openId=openId;\r\n                                net.post(\"/user/login\",{\r\n                                    qqid:openId,\r\n                                    qqimg:obj.figureurl_qq_1\r\n                                }).then(function (data) {\r\n                                    if(data.code==200)\r\n                                    {\r\n                                        _this.$notify({\r\n                                            title: '登录成功',\r\n                                            type: 'success'\r\n                                        });\r\n                                        session.clear()\r\n                                        session.update(data.data,_this.remember);\r\n                                        setTimeout(function () {\r\n                                            location.href=\"../console/console.html\"\r\n                                        },1500);\r\n                                    }\r\n                                    else if(data.code==2)\r\n                                    {\r\n                                        sessionStorage.setItem(\"qqid\",openId);\r\n                                        sessionStorage.setItem(\"qqname\",obj.nickname);\r\n                                        sessionStorage.setItem(\"qqimg\",obj.figureurl_qq_1);\r\n                                        window.open(location.protocol+\"//\"+location.host+\"/html/web/controller/register/registerqq.html\")\r\n                                    }\r\n                                    else\r\n                                    {\r\n                                        _this.$notify({\r\n                                            title: data.msg,\r\n                                            type: 'error'\r\n                                        });\r\n                                    }\r\n                                })\r\n                            })\r\n                        })\r\n                    }\r\n                }\r\n            },500);\r\n        }\r\n    },\r\n    created:function () {\r\n        var _this=this;\r\n        window.addEventListener('message',function(e){\r\n            if(e.origin==location.protocol+\"//\"+location.host)\r\n            {\r\n                var obj;\r\n                try\r\n                {\r\n                    obj=JSON.parse(e.data);\r\n                }\r\n                catch (err)\r\n                {\r\n                    return;\r\n                }\r\n                if(!obj.name || !obj.password)\r\n                {\r\n                    return;\r\n                }\r\n                net.post(\"/user/login\",{\r\n                    name:obj.name,\r\n                    password:obj.password,\r\n                }).then(function (data) {\r\n                    if(data.code==200)\r\n                    {\r\n                        _this.$notify({\r\n                            title: '登录成功',\r\n                            type: 'success'\r\n                        });\r\n                        session.clear()\r\n                        session.update(data.data,_this.remember);\r\n                        setTimeout(function () {\r\n                            location.href=\"../console/console.html\"\r\n                        },1000);\r\n                    }\r\n                    else\r\n                    {\r\n                        _this.$notify({\r\n                            title: data.msg,\r\n                            type: 'error'\r\n                        });\r\n                    }\r\n                })\r\n            }\r\n        },false);\r\n    }\r\n})\r\n$.ready(function () {\r\n    document.body.onkeydown=function (e) {\r\n        var event=window.event || e;\r\n        if(event.keyCode==13)\r\n        {\r\n            var event1 = document.createEvent('HTMLEvents');\r\n            event1.initEvent(\"click\", true, true);\r\n            event1.eventType = 'message';\r\n            document.getElementById(\"login\").dispatchEvent(event1);\r\n        }\r\n    }\r\n})\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./web/controller/login/login.js\n// module id = 157\n// module chunks = 10"],"sourceRoot":""}