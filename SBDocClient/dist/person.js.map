{"version":3,"sources":["webpack:///./web/person/person.js","webpack:///./web/director/imgFile.js"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,CAAC,C;;;;;;;;ACzHD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA,SAAS,qCAAqC;AAC9C;AACA;AACA,SAAS,0CAA0C;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA,mB","file":"person.js","sourcesContent":["/**\n * Created by sunxin on 2016/12/17.\n */\nvar mainNav=require(\"../component/mainNav.vue\")\nvar imgFile=require(\"../director/imgFile\")\nvar proxyImg=require(\"../director/proxyImg\")\nvar config=require(\"../util/config\");\nif(!session.get(\"id\"))\n{\n    location.href=\"../login/login.html\"\n}\nvar vue=new Vue({\n    el: \"#app\",\n    data: {\n        infoShow:1,\n        session:$.clone(session.raw()),\n        oldPass:\"\",\n        newPass:\"\",\n        newPass1:\"\",\n        savePending:false,\n        passPending:false,\n    },\n    components:{\n        \"mainnav\":mainNav,\n    },\n    methods:{\n        saveInfo:function () {\n            var _this=this;\n            var obj={};\n            if($.query(\"#file\").value)\n            {\n                obj.photo=$.query(\"#file\").files[0];\n            }\n            if(this.session.age)\n            {\n                obj.age=this.session.age\n            }\n            if(this.session.sex)\n            {\n                obj.sex=this.session.sex\n            }\n            if(this.session.company)\n            {\n                obj.company=this.session.company\n            }\n            if(this.session.qq)\n            {\n                obj.qq=this.session.qq\n            }\n            if(this.session.email)\n            {\n                obj.email=this.session.email\n            }\n            obj.userid=this.session.id;\n            this.savePending=true;\n            net.upload(\"post\",\"/user/save\",obj).then(function (data) {\n                _this.savePending=false;\n                if(data.code==200)\n                {\n                    _this.$notify({\n                        title: '更新成功',\n                        type: 'success'\n                    });\n                    session.update(data.data);\n                    _this.session=$.clone(session.raw());\n                    _this.$emit(\"updatePhoto\",data.data.photo);\n                }\n                else\n                {\n                    _this.$notify({\n                        title: data.msg,\n                        type: 'error'\n                    });\n                }\n            })\n        },\n        editPass:function () {\n            if(!this.oldPass || !this.newPass || !this.newPass1)\n            {\n                this.$message.error(\"请填写完整信息\");\n                return;\n            }\n            else if(this.newPass!=this.newPass1)\n            {\n                this.$message.error(\"两次填写的密码不一致\");\n                return;\n            }\n            var _this=this;\n            this.passPending=true;\n            net.put(\"/user/editpass\",{\n               userid:_this.session.id,\n                oldpass:_this.oldPass,\n                newpass:_this.newPass\n            },{\n                \"content-type\":\"application/x-www-form-urlencoded\"\n            }).then(function (data) {\n                _this.passPending=false;\n                if(data.code==200)\n                {\n                    _this.$notify({\n                        title: '修改成功',\n                        type: 'success'\n                    });\n                    _this.oldPass=\"\";\n                    _this.newPass=\"\";\n                    _this.newPass1=\"\";\n                }\n                else\n                {\n                    _this.$notify({\n                        title: data.msg,\n                        type: 'error'\n                    });\n                }\n            })\n        }\n    },\n    directives:{\n        \"imgfile\":imgFile,\n        \"proxy\":proxyImg\n    }\n})\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./web/person/person.js\n// module id = 207\n// module chunks = 0","/**\n * Created by sunxin on 16/8/29.\n */\nfunction getUrl(el,file) {\n    if(!file)\n    {\n        return null;\n    }\n    if(el.img && document.getElementById(el.img).src.match(/^blob\\:/i))\n    {\n        el.destoryFunc(document.getElementById(el.img).src);\n    }\n    var url = el.createFunc(file);\n    return url;\n}\nvar obj={\n    bind:function (el,binding) {\n        if (window.createObjectURL != undefined) { // basic\n            el.createFunc = window.createObjectURL;\n            el.destoryFunc=window.revokeObjectURL;\n        }  else if (window.URL != undefined) { // mozilla(firefox)\n            el.createFunc = window.URL.createObjectURL;\n            el.destoryFunc=window.URL.revokeObjectURL;\n        } else if (window.webkitURL != undefined) { // webkit or chrome\n            el.createFunc = window.webkitURL.createObjectURL;\n            el.destoryFunc=window.webkitURL.revokeObjectURL;\n        }\n        el.img=binding.value;\n        el.onchange=function () {\n            var url=getUrl(el,el.files[0]);\n            if(el.img && url)\n            {\n                document.getElementById(el.img).src=url;\n            }\n        }\n    },\n    unbind:function (el) {\n        el.onchange=null;\n        if(el.img && document.getElementById(el.img) && document.getElementById(el.img).src.test(/^blob\\:/i))\n        {\n            el.destoryFunc(document.getElementById(el.img).src);\n        }\n    },\n    update:function (el) {\n        if(el.img)\n        {\n            return;\n        }\n        setTimeout(function () {\n            el.img=el;\n        },100);\n    }\n}\n\nmodule.exports=obj;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./web/director/imgFile.js\n// module id = 61\n// module chunks = 0"],"sourceRoot":""}